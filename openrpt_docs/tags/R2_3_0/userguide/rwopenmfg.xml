<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.3//EN"
"http://www.oasis-open.org/docbook/xml/4.3/docbookx.dtd">
<?xml-stylesheet href="docbook-omfg.css" type="text/css"?>
<chapter>
  <title>OpenMFG Topics</title>

  <para>This chapter contains focuses on topics related to the report writer
  embedded within the OpenMFG ERP Suite. While OpenRPT users may find useful
  information here, this chapter is dedicated primarily to OpenMFG
  users.</para>

  <sect1>
    <title>Labels and Forms</title>

    <para>The OpenMFG report writer enables you to customize report
    definitions that produce standard sized labels for shipments and generate
    them from the OpenMFG client. It also enables you to define unique report
    definitions, called forms, for packing lists and bills of lading that can
    be linked to one or more customers. There are three steps necessary to
    define and generate a label or form:</para>

    <simpara>Step 1 - Report Definition: Define the label or form’s report
    definition with the OpenMFG report writer</simpara>

    <simpara>Step 2 - Report Definition Link: Link the label or form to the
    report definition. For forms, link the form to one or more
    customers</simpara>

    <simpara>Step 3 - Generate Labels or Forms: Generate labels or forms from
    the OpenMFG client using options on S/R - Forms menu</simpara>

    <para>There are six sessions that generate labels of forms and they are
    accessed through S/R - Forms menu: They are:</para>

    <itemizedlist>
      <listitem>
        <para>Print Packing List</para>
      </listitem>

      <listitem>
        <para>Print Shipping Form</para>
      </listitem>

      <listitem>
        <para>Print Shipping Forms</para>
      </listitem>

      <listitem>
        <para>Print Shipping Labels by S/O #</para>
      </listitem>

      <listitem>
        <para>Print Shipping Labels by Invoice</para>
      </listitem>

      <listitem>
        <para>Print Receiving Labels by P/O #</para>
      </listitem>
    </itemizedlist>

    <para>Though several of these forms and labels can be generated from other
    places within OpenMFG, the S/R, Forms menu is a single menu from which all
    can be generated:</para>

    <para><figure>
        <title>OpenMFG Forms Menu</title>

        <mediaobject>
          <imageobject>
            <imagedata fileref="images/C03_300_LabelFrmsMenu.png" />
          </imageobject>
        </mediaobject>
      </figure></para>

    <para>In the next few sections we will examine the setup for producing
    custom labels and forms. Remember, forms are named report definitions that
    are linked to a customer. Labels are report definitions that are linked to
    a unique name but not a specific customer. However, you could create a
    report definition for a label and assign it a name that references a
    customer. This is appropriate when a customer has a unique label
    requirement and you want the name of the report definition to reflect
    this.</para>

    <sect2>
      <title>Linking a Form Name to a Report Definition and Customer</title>

      <para>The cross referencing capability in OpenMFG is a very powerful
      feature that makes if possible to, for example, to define report
      definitions that are unique to a customer or types of customers.</para>

      <para>When you define a Customer (see below) you will assign the
      customer a Customer Type and a preferred Shipping Form:</para>

      <para><figure>
          <title>Customer Master</title>

          <mediaobject>
            <imageobject>
              <imagedata fileref="images/C03_307_CustomersForms.png" />
            </imageobject>
          </mediaobject>
        </figure></para>

      <para>The entries that display in the Shipping Form choice field are
      first defined using the session Shipping Forms located on the S/O -
      Master Information menu:</para>

      <para><figure>
          <title>Shipping Forms</title>

          <mediaobject>
            <imageobject>
              <imagedata fileref="images/C03_305_ShippingForms.png" />
            </imageobject>
          </mediaobject>
        </figure></para>

      <para>This session enables the creation of a unique form name that is
      linked to an OpenMFG report definition. Running the session Print
      Shipping Form from the menu S/R - Forms causes OpenMFG to display the
      customer’s preferred shipping form in the field Shipping Form.</para>

      <para>This technique makes it possible to create logical form names that
      are tied to specific report definitions and to one or more
      customers.</para>

      <para>Referring back to the Customer master you will also note the
      Customer Type field. This also controls the printing of forms. The
      following session enables you to define, by Customer Type, the report
      definition that is used to generate the specific documents
      listed:</para>

      <para><figure>
          <title>Customer Form Assignments</title>

          <mediaobject>
            <imageobject>
              <imagedata fileref="images/C03_309_CustomerFormAssign.png" />
            </imageobject>
          </mediaobject>
        </figure></para>

      <para>The following diagrams recap the setup just described for Customer
      Form Assignments:</para>

      <para><figure>
          <title>Linking Customers to Customer Form Assignments</title>

          <mediaobject>
            <imageobject>
              <imagedata fileref="images/C03_309_ZZZCustFormAssignFlow.png" />
            </imageobject>
          </mediaobject>
        </figure></para>

      <para>We have also looked at the screens that link a customer to a
      shipping form. The following diagram recaps this setup:</para>

      <para><figure>
          <title>Linking Report Definitions to Sales Orders</title>

          <mediaobject>
            <imageobject>
              <imagedata fileref="images/C03_309_YYYCustFormAssignFlow.png" />
            </imageobject>
          </mediaobject>
        </figure></para>

      <para>Later in this section we will look at the parameters values that
      are passed to the report definition when Print Shipping Form and Print
      Packing List are run from the S/R Forms menu. But first, let’s look at
      how OpenMFG enables you to define unique label definitions.</para>
    </sect2>

    <sect2>
      <title>Linking a Label to a Name and Report Definition</title>

      <para>The last three options on the S/R - Forms menu are:</para>

      <itemizedlist>
        <listitem>
          <para>Print Shipping Labels by S/O #</para>
        </listitem>

        <listitem>
          <para>Print Shipping Labels by Invoice</para>
        </listitem>

        <listitem>
          <para>Print Receiving Labels by P/O #</para>
        </listitem>
      </itemizedlist>

      <para>The cross-reference to the report definition for these three is a
      little simpler. On the System menu’s Master Information a sub-menu is
      the Label Forms option:</para>

      <para><figure>
          <title>Label Forms</title>

          <mediaobject>
            <imageobject>
              <imagedata fileref="images/C03_350_LabelFormLink.png" />
            </imageobject>
          </mediaobject>
        </figure></para>

      <para>When one of the three options label options on the S/R - Forms
      menu (listed in the table below) is run, the user is presented with a
      drop down choice field called Report Name in which is displayed the form
      name linked to a report definition using the session Label Form.</para>

      <simpara>System - Master Information: Label Forms: Enables the creation
      of a unique form name that is linked to an OpenMFG report definition.
      The report name displays in the Report Name field on the following label
      reports:</simpara>

      <itemizedlist>
        <listitem>
          <para>Print Shipping Labels by S/O #</para>
        </listitem>

        <listitem>
          <para>Print Shipping Labels by Invoice</para>
        </listitem>

        <listitem>
          <para>Print Receiving Labels by P/O #</para>
        </listitem>
      </itemizedlist>
    </sect2>

    <sect2>
      <title>Label and Form Parameters</title>

      <para>When a user runs generates a form or a label from an option on
      S/R, Forms menu, the OpenMFG client passes parameter values to the
      selected form’s definition (more on this shortly) based on the user’s
      entries. These parameter values can be used by the report’s SQL to
      retrieve information from the database.</para>

      <para>The tables below identify fields on the sessions that are
      available on the S/R Forms menu. The parameters column provides the name
      of the parameter that corresponds to the field if it is in fact a
      parameter (not all are). Also provided, in the Table Reference column is
      the name of a table that the author of the report may choose to query to
      locate information in the database based on the parameter value provided
      by the user.</para>

      <para>It is important to note that some fields are not parameters and
      some parameters do not correspond to tables. For example the parameters
      labelTo and labelFrom pass parameter values that can be used in the
      report definition to control the number of labels that print. These
      parameters do not correspond to a table.</para>

      <sect3>
        <title>Print Packing List</title>

        <para>The option Print Packing List, located on the S/R - Forms menu,
        enables you to generate a packing list by entering a sales order
        number (see the section Linking a Form Name to a Report Definition and
        Customer to see how this is setup). At run-time, the order’s internal
        reference number is passed to the report definition as the value for
        the parameter sohead_id. This parameter can be employed in a query
        that derives information from a join on the tables cohead and shipto
        to retrieve information pertinent to shipping labels.</para>

        <para><table>
            <title>Parameters passed to the Packing List report</title>

            <tgroup cols="3">
              <tbody>
                <row rowsep="1">
                  <entry colname="1">Field</entry>

                  <entry colname="2">Parameter</entry>

                  <entry colname="3">Table Reference</entry>
                </row>

                <row rowsep="0">
                  <entry colname="1">Sales Order #</entry>

                  <entry colname="2">sohead_id</entry>

                  <entry colname="3">cohead</entry>
                </row>
              </tbody>
            </tgroup>
          </table></para>
      </sect3>

      <sect3>
        <title>Print Shipping Form</title>

        <para>The option Print Shipping Forms, located on the S/R - Forms
        menu, enables you to see a customer’s default Shipping Form by
        entering a sales order number (see the section Linking a Form Name to
        a Report Definition and Customer to see how this is setup) and
        override it if you chose.</para>

        <para>At run-time, the order’s internal reference number is passed to
        the report definition in the value of the parameter cosmisc_id. This
        parameter can be employed in a query that derives information from a
        join on the tables cosmisc and shipto to retrieve information
        pertinent to shipping labels.</para>

        <para>The table below shows these and other parameters that are passed
        to the report definition and may be used to query other tables (if
        applicable) or display their value on the report. For example, the
        user’s input for Watermark is passed in the parameter watermark and
        may be referenced in a report’s Properties and displayed as a dynamic
        watermark.</para>

        <para><table>
            <title>Parameters passed to the Shipping Forms reports</title>

            <tgroup cols="3">
              <tbody>
                <row rowsep="1">
                  <entry colname="1">Field</entry>

                  <entry colname="2">Parameter</entry>

                  <entry colname="3">Table Reference</entry>
                </row>

                <row rowsep="1">
                  <entry colname="1">Sales Order #</entry>

                  <entry colname="2">cosmisc_id</entry>

                  <entry colname="3">cosmisc</entry>
                </row>

                <row rowsep="1">
                  <entry colname="1">Shipping Form</entry>

                  <entry colname="2">not a parameter</entry>

                  <entry colname="3">n/a</entry>
                </row>

                <row rowsep="1">
                  <entry colname="1">Shipping Charges</entry>

                  <entry colname="2">shipchrg_id</entry>

                  <entry colname="3">shipchrg</entry>
                </row>

                <row rowsep="1">
                  <entry colname="1"># of Copies</entry>

                  <entry colname="2">not a parameter</entry>

                  <entry colname="3">n/a</entry>
                </row>

                <row rowsep="1">
                  <entry colname="1">Watermark</entry>

                  <entry colname="2">watermark</entry>

                  <entry colname="3">n/a</entry>
                </row>

                <row rowsep="0">
                  <entry colname="1">Show Prices</entry>

                  <entry colname="2">showcosts</entry>

                  <entry colname="3">n/a</entry>
                </row>
              </tbody>
            </tgroup>
          </table></para>
      </sect3>

      <sect3>
        <title>Print Shipping Forms</title>

        <para>The session Print Shipping Forms prints all orders that are at
        shipping and have not yet had shipping forms printed or for which a
        shipping change has been recorded. You can see orders at shipping and
        the status of their shipping forms by going to the session Maintain
        Shipping Contents on the menu S/R - Shipping. The column “Prnt’ed”
        indicates the status of shipping forms.</para>

        <para>Using Print Shipping Forms an order’s shipping forms may only be
        printed once unless the shipment has been changed and then the field
        Print Shipping Forms for Changed Shipments must be checked. Note, the
        session Print Shipping Form (the second option on the S/R - Forms
        menu) will always enable you to print a specific sales order’s
        shipping form.</para>

        <para>The table below identifies screen literals, parameters, and a
        table reference to assist you in creating your report definitions for
        labels:</para>

        <para><table>
            <title>Field descriptions for Print Shipping Forms</title>

            <tgroup cols="3">
              <tbody>
                <row rowsep="1">
                  <entry colname="1">Field</entry>

                  <entry colname="2">Parameter</entry>

                  <entry colname="3">Table Reference</entry>
                </row>

                <row rowsep="1">
                  <entry colname="1">Print Shipping Forms for New
                  Shipments</entry>

                  <entry colname="2">not a parameter</entry>

                  <entry colname="3">n/a</entry>
                </row>

                <row rowsep="1">
                  <entry colname="1">Print Shipping Forms for Changed
                  Shipments</entry>

                  <entry colname="2">not a parameter</entry>

                  <entry colname="3">n/a</entry>
                </row>

                <row rowsep="1">
                  <entry colname="1"># of Copies</entry>

                  <entry colname="2">not a parameter</entry>

                  <entry colname="3">n/a</entry>
                </row>

                <row rowsep="1">
                  <entry colname="1">Watermark</entry>

                  <entry colname="2">watermark</entry>

                  <entry colname="3">n/a</entry>
                </row>

                <row rowsep="0">
                  <entry colname="1">Show Prices</entry>

                  <entry colname="2">showcosts</entry>

                  <entry colname="3">n/a</entry>
                </row>
              </tbody>
            </tgroup>
          </table></para>
      </sect3>

      <sect3>
        <title>Print Shipping Labels by S/O #</title>

        <para>The Print Shipping Labels by SO # session is found on the S/R -
        Forms menu. The is user prompted to enter a Sales Order number, select
        a label form (remember that these were defined in the System - Master
        Information: Label Forms session) in the Report Name field, and enter
        a range in the Labels: from and to fields to control the number of
        labels printed. This approach enables you to pre-define a variety of
        label formats.</para>

        <para>The table below identifies screen literals, parameters, and a
        table reference to assist you in creating your report definitions for
        labels. Note that address information for orders that are destined for
        customer ship-to addresses is contained the table shipto and can be
        accused with a join to information in the table cohead using the value
        passed by the parameter sohead_id.</para>

        <para><table>
            <title></title>

            <tgroup cols="3">
              <tbody>
                <row rowsep="1">
                  <entry colname="1">Screen Literal</entry>

                  <entry colname="2">Parameter</entry>

                  <entry colname="3">Table Reference</entry>
                </row>

                <row rowsep="1">
                  <entry colname="1">Sales Order #</entry>

                  <entry colname="2">sohead_id</entry>

                  <entry colname="3">cohead</entry>
                </row>

                <row rowsep="1">
                  <entry colname="1">Report Name</entry>

                  <entry colname="2">not a parameter</entry>

                  <entry colname="3">n/a</entry>
                </row>

                <row rowsep="1">
                  <entry colname="1">Label from</entry>

                  <entry colname="2">labelFrom</entry>

                  <entry colname="3">n/a</entry>
                </row>

                <row rowsep="0">
                  <entry colname="1">Labels to</entry>

                  <entry colname="2">labelTo</entry>

                  <entry colname="3">n/a</entry>
                </row>
              </tbody>
            </tgroup>
          </table></para>
      </sect3>

      <sect3>
        <title>Print Shipping Labels by Invoice</title>

        <para>The Print Shipping Labels by Invoice session is found on the S/R
        - Forms menu. The user is prompted to enter an Invoice Number, select
        a label form (remember that these were defined in the System - Master
        Information: Label Forms session) in the Report Name field, and enter
        a range in the Labels: from and to fields to control the number of
        labels printed. This approach enables you to pre-define a variety of
        label formats.</para>

        <para>The table below identifies screen literals, parameters, and a
        table reference to assist you in creating your report definitions for
        labels:</para>

        <para><table>
            <title></title>

            <tgroup cols="3">
              <tbody>
                <row rowsep="1">
                  <entry colname="1">Screen Literal</entry>

                  <entry colname="2">Parameter</entry>

                  <entry colname="3">Table Reference</entry>
                </row>

                <row rowsep="1">
                  <entry colname="1">Invoice #</entry>

                  <entry colname="2">invchead_id</entry>

                  <entry colname="3">invchead</entry>
                </row>

                <row rowsep="1">
                  <entry colname="1">Report Name</entry>

                  <entry colname="2">n/a</entry>

                  <entry colname="3">n/a</entry>
                </row>

                <row rowsep="1">
                  <entry colname="1">Label from</entry>

                  <entry colname="2">labelFrom</entry>

                  <entry colname="3">n/a</entry>
                </row>

                <row rowsep="0">
                  <entry colname="1">Labels to</entry>

                  <entry colname="2">labelTo</entry>

                  <entry colname="3">n/a</entry>
                </row>
              </tbody>
            </tgroup>
          </table></para>
      </sect3>

      <sect3>
        <title>Print Receiving Labels by PO #</title>

        <para>The Print Receiving Labels by PO # session is found on the S/R -
        Forms menu. The user is prompted to enter an Purchase Order number,
        select a label form (remember that these were defined in the System -
        Master Information: Label Forms session) in the Report Name field, and
        enter a range in the Labels: from and to fields to control the number
        of labels printed. This approach enables you to pre-define a variety
        of label formats.</para>

        <para>The table below identifies screen literals, parameters, and a
        table reference to assist you in creating your report definitions for
        labels. Note that receiving line item information is contained in the
        table porecv and can be accessed with a join to information in the
        table pohead using the value passed by the parameter pohead_id. In
        this way, receiving labels that contain item, description, quantity
        and other information pertinent to receiving and putaway can be
        generated.</para>

        <para><table>
            <title></title>

            <tgroup cols="3">
              <tbody>
                <row rowsep="1">
                  <entry colname="1">Screen Literal</entry>

                  <entry colname="2">Parameter</entry>

                  <entry colname="3">Table Reference</entry>
                </row>

                <row rowsep="1">
                  <entry colname="1">P/O #</entry>

                  <entry colname="2">pohead_id</entry>

                  <entry colname="3">pohead</entry>
                </row>

                <row rowsep="1">
                  <entry colname="1">Report Name</entry>

                  <entry colname="2">n/a</entry>

                  <entry colname="3">n/a</entry>
                </row>

                <row rowsep="1">
                  <entry colname="1">Label from</entry>

                  <entry colname="2">labelFrom</entry>

                  <entry colname="3">n/a</entry>
                </row>

                <row rowsep="0">
                  <entry colname="1">Labels to</entry>

                  <entry colname="2">labelTo</entry>

                  <entry colname="3">n/a</entry>
                </row>
              </tbody>
            </tgroup>
          </table></para>
      </sect3>
    </sect2>

    <sect2>
      <title>Report Definition for Custom Labels</title>

      <para>To begin you must define a label’s report definition using the
      OpenMFG report writer. Previous sections of this guide have provided
      detailed explanations on the mechanics of creating report definitions.
      Below are areas of interest that are specific to a label definition in
      general and the sample label shown.</para>

      <sect3>
        <title>Generating a Label Sheet</title>

        <para>Before we begin, let’s see how the custom label was printed and
        what it looks like. The customer label was printed through the Print
        Labels by Sales Order option found on the S/R, Forms menu:</para>

        <para><figure>
            <title>Custom Shipping Labels by Sales Order</title>

            <mediaobject>
              <imageobject>
                <imagedata fileref="images/C03_310_GenLabelReport.png" />
              </imageobject>
            </mediaobject>
          </figure></para>

        <para>Note that the user enters the Sales Order for which the labels
        are to be generated, selects a Report Name, and enters a value for
        Labels From and To - this controls the number of labels
        printed.</para>

        <para>The Sales Order number is passed to the report definition as a
        parameter called sohead_id which can be used in an SQL query to look
        up additional information about the order in the table cohead.</para>

        <para>Likewise the values entered for Label From and Label To are
        passed as the parameters labelFrom and labelTo. These parameters do
        not correspond to a specific table, but later we will learn how to use
        them in conjunction with the sequence table to create multiple
        labels.</para>

        <para>The Report Name choice field lists all of the Reports Names that
        have been linked to a report definition using the session Forms found
        on the System, Master Information menu. Only Report Names linked to
        report definitions using the Forms session will display in this choice
        field.</para>

        <para>The report definition we will look at generates the following
        labels:</para>

        <para><figure>
            <title>Custom Labels with Bar Codes</title>

            <mediaobject>
              <imageobject>
                <imagedata fileref="images/C03_315_SampleLabelsSheet.png" />
              </imageobject>
            </mediaobject>
          </figure></para>

        <para>Note that three labels were generated based on a user entry for
        Label From of 1 and Label To of 3.</para>
      </sect3>

      <sect3>
        <title>Label Report Definition</title>

        <para>Let’s take a look at the report definition that generated these
        labels.</para>

        <para><figure>
            <title>Sample Report Definition for a Shipping Label</title>

            <mediaobject>
              <imageobject>
                <imagedata fileref="images/C03_320_LabelReportDef.png" />
              </imageobject>
            </mediaobject>
          </figure></para>

        <para>As noted earlier, the OpenMFG report writer supports several
        standard label sizes. This report uses an Avery 5263 label size. The
        Page Setup session is used to select a label size.</para>

        <note>
          <title>Note</title>

          <para>The report writer supports Avery Standard Labels. It also
          supports portrait or landscape, Letter, Legal, and A4
          documents.</para>
        </note>
      </sect3>
    </sect2>

    <sect2>
      <title>Report Definition Page Setup</title>

      <para>To open the Page Setup session, in the report writer:</para>

      <itemizedlist>
        <listitem>
          <para>Pull down the Document menu</para>
        </listitem>

        <listitem>
          <para>Click on the “Page Setup” option</para>
        </listitem>
      </itemizedlist>

      <para><figure>
          <title>Selecting Label Type</title>

          <mediaobject>
            <imageobject>
              <imagedata fileref="images/C03_330_RepDefPageSetup.png" />
            </imageobject>
          </mediaobject>
        </figure></para>

      <para>Labels use a Paper Size type of "Labels." The following
      pre-defined Label Types are supported:</para>

      <itemizedlist>
        <listitem>
          <para>Avery 5263</para>
        </listitem>

        <listitem>
          <para>Avery 5264</para>
        </listitem>

        <listitem>
          <para>Avery 8460</para>
        </listitem>

        <listitem>
          <para>CILS ALPI-9200-1</para>
        </listitem>
      </itemizedlist>

      <para>This controls the size of the Detail section of the report which
      is the only portion of the report definition that should be used for a
      label report definition.</para>

      <sect3>
        <title>Displaying a Parameter Value</title>

        <para>We noted earlier that one of the parameters passed to the report
        definition at run-time was labelTo. You may have noticed that the
        labels show the value of the user’s input for this parameter in the
        lower right corner of each label. This was accomplished by creating a
        special Properties (Field) that references “Parameter Query” in the
        Query Source field and the name of the parameter (labelTo) in the
        Column field.</para>

        <para><figure>
            <title>Parameter Values for Label</title>

            <mediaobject>
              <imageobject>
                <imagedata fileref="images/C03_340_DisplayParamValue.png" />
              </imageobject>
            </mediaobject>
          </figure></para>

        <para>The other values for fields on this report definition were
        retrieved from the database through and SQL query.</para>
      </sect3>

      <sect3>
        <title>Label Report Query Definition</title>

        <para>The query in the report definition is sophisticated and yet
        fairly straight forward. It is shown below:</para>

        <programlisting>SELECT sequence_value, cohead.cohead_number, cohead.cohead_shipto_id,
       cohead.cohead_custponumber, shipto.shipto_name, shipto.shipto_address1,
       shipto.shipto_address2, shipto.shipto_address3, shipto.shipto_city,
       shipto.shipto_state, shipto.shipto_zipcode
FROM public.cohead cohead, public.shipto shipto, public.sequence
WHERE cohead.cohead_shipto_id = shipto.shipto_id
  AND ((cohead.cohead_id=&lt;? value("sohead_id") ?&gt;)
  AND (sequence.sequence_value BETWEEN &lt;? value("labelFrom") ?&gt; AND &lt;? value("labelTo") ?&gt;));</programlisting>

        <para>Let’s take a look at each section of this query:</para>

        <simpara>SELECT SECTION: This portion of the SQL retrieves column
        values from three tables: sequence, cohead, and shipto. The values
        retrieved are used to define the Columns in the Property (Fields)
        session which controls what and how dynamic information is displayed
        on the label. The descriptions of these fields are self
        explanatory.</simpara>

        <simpara>FROM SECTION: This portion of the SQL specifies the tables
        from which the query retrieves the data:</simpara>

        <para><table>
            <title></title>

            <tgroup cols="2">
              <tbody>
                <row rowsep="1">
                  <entry colname="1">cohead</entry>

                  <entry colname="2">This table contains Header information
                  for Sales Orders</entry>
                </row>

                <row rowsep="1">
                  <entry colname="1">shipto</entry>

                  <entry colname="2">This table contains customer shipping
                  addresses</entry>
                </row>

                <row rowsep="0">
                  <entry colname="1">sequence</entry>

                  <entry colname="2">This table contains a sequence of numbers
                  from 1 to 1000 and facilitates the execution of the SQL
                  multiple times in order to generate multiple labels</entry>
                </row>
              </tbody>
            </tgroup>
          </table></para>

        <para></para>

        <simpara>WHERE SECTION: The WHERE section of the SQL does the
        following:</simpara>

        <itemizedlist>
          <listitem>
            <para>Retrieves the row in the table cohead where the column
            cohead_id equals the value for the parameter passed from the user
            (the user enters the order number but the program passes the
            order’s system generated cohead_id).</para>
          </listitem>

          <listitem>
            <para>Joins the tables cohead and shipto on the columns
            cohead_shipto_id and shipto_id.</para>
          </listitem>

          <listitem>
            <para>Causes the SQL to “fire” multiple times to print multiple
            labels. The table sequence contains a sequential list of integers
            from 1 to 1000 and is used by the query such that it repeats for
            the number of times contained in the range defined by the
            labelFrom and labelTo parameters. The information returned is the
            same each time but by design the report writer generates one label
            each time the SQL returns a row of information.</para>
          </listitem>
        </itemizedlist>

        <para>The table shipto contains the specific the shipping address
        information that appears on the label. Also note that parameters are
        contained inside the MetaSQL tags &lt;? and ?&gt;.</para>

        <note>
          <title>Note:</title>

          <para>Finally, for the sake of simplicity, this sample label’s SQL
          only generates labels for orders in which the shipping address is
          selected from the list of Ship-To’s by customer. In this case this
          scenario the shipping address is contained in the table shipto. For
          orders where the ship to address is merely copied using the button
          COPY TO SHIP-TO -&gt; button, the address information is contained
          in the table cohead. A more sophisticated query, leveraging MetaSQL
          could test for this condition (the value of column cohead_shipto_id
          = -1 in table cohead) and retrieve the shipping information directly
          cohead. If you decide to re-create this label, make certain to test
          it against a Sales Order that uses an address from the list of
          pre-defined customer ship-to’s.</para>
        </note>
      </sect3>

      <sect3>
        <title>Linking Label Name to Report Definition</title>

        <para>Once the report definition is created, it is time to link it to
        a user defined Form Name:</para>

        <itemizedlist>
          <listitem>
            <para>Pull down the OpenMFG System menu</para>
          </listitem>

          <listitem>
            <para>Click on the Master Information menu</para>
          </listitem>

          <listitem>
            <para>Select the option “Forms”</para>
          </listitem>

          <listitem>
            <para>Click the NEW button</para>
          </listitem>
        </itemizedlist>

        <para><figure>
            <title>Linking Label Names to Report Definitions</title>

            <mediaobject>
              <imageobject>
                <imagedata fileref="images/C03_350_LabelFormLink.png" />
              </imageobject>
            </mediaobject>
          </figure></para>

        <para>The Form Name field is a user friendly description of the label
        displayed to the user when the user is selecting a label type to
        print. It could, for instance, link to a special report definition in
        the Report field that is unique to a specific customer. The # of
        Labels per Page field is not used.</para>

        <para>To print your labels, first create a Sales Order that uses a
        pre-defined customer ship-to address. Then:</para>

        <itemizedlist>
          <listitem>
            <para>Pull down the OpenMFG S/R menu</para>
          </listitem>

          <listitem>
            <para>Click on the Forms menu</para>
          </listitem>

          <listitem>
            <para>Select the option Print Shipping Labels by SO #</para>
          </listitem>
        </itemizedlist>

        <para><figure>
            <title>Generating Custom Shipping Labels</title>

            <mediaobject>
              <imageobject>
                <imagedata fileref="images/C03_310_GenLabelReport.png" />
              </imageobject>
            </mediaobject>
          </figure></para>

        <itemizedlist>
          <listitem>
            <para>In the field Sales Order #, enter the order number sales
            order you just created</para>
          </listitem>

          <listitem>
            <para>In the choice field Report Name, select the name of the
            label you just liked to your report definition using the Forms
            session</para>
          </listitem>

          <listitem>
            <para>Set the Label from field to 1 and the To field to 3</para>
          </listitem>

          <listitem>
            <para>Click the PRINT button</para>
          </listitem>
        </itemizedlist>

        <para>OpenMFG will print 3 labels, based on the unique report
        definition you linked to the Report Name selected, that contain
        information for the customer’s ship-to address tied to the order you
        entered.</para>
      </sect3>
    </sect2>
  </sect1>

  <sect1>
    <title>Report Importing Tools</title>

    <para>In Chapter One we learned how to save a report definition to an XML
    (Extensible Markup Language) file that is external to the OpenMFG
    database. These files may be used as a backup and as a means to share
    reports definitions throughout the OpenMFG community.</para>

    <para>In this chapter we will learn about two tools that facilitate the
    importation of one or more report definitions using their XML definition
    file. We have already seen that it is possible to use the report writer
    itself to open a report from its XML definition file so the main benefit
    to these tools is the ability to import multiple files simultaneously, or,
    in the case of the command line tool, write scripts that do the
    importation.</para>

    <sect2>
      <title>importrptgui</title>

      <para>The first tool we will look at is the Report Import Tool. This
      tool runs on all supported client platforms and provides a simple, easy
      to use graphical user interface importation capability. The name of the
      binary file that you execute from a command line to start the Report
      Import Tool is importrptgui (note that on the Windows platform you will
      include the ‘.exe’ suffix).</para>

      <para>The Report Import Tool is designed to simplify the process of
      uploading multiple reports to an OpenMFG database. For optimal
      performance, the importrptgui file should be placed in the same
      directory as the OpenMFG (‘.exe’ on Windows) client file.</para>

      <para>When you open the utility, you will notice that you are brought to
      the standard OpenMFG log in screen. Log in to the database where you
      want to upload your reports. As with the OpenMFG client, you may click
      the OPTIONS button to change these settings.</para>

      <para>From the command line, and in the directory where the OpenMFG
      client files and the importrptgui binary files are co-located, run
      importrptgui. You will see:</para>

      <para><figure>
          <title>Main Screen of importrptgui Tool</title>

          <mediaobject>
            <imageobject>
              <imagedata fileref="images/C04_100_RptImportTool.png" />
            </imageobject>
          </mediaobject>
        </figure></para>

      <para>The definitions that you import with this tool may be newly
      created reports, or, updated versions of already existing
      reports.</para>

      <para>Using the ADD button on the GUI screen, browse for the directory
      where you have saved your report definition .xml files. Once you have
      located and opened the directory where the files are stored, you may add
      them individually by double-clicking on them one-at-a-time. Or, you may
      select all or a subset of the total using your window manager.</para>

      <para><figure>
          <title>Importing Report Definitions in XML Format</title>

          <mediaobject>
            <imageobject>
              <imagedata fileref="images/C04_110_RptImportToolSelectFiles.png" />
            </imageobject>
          </mediaobject>
        </figure></para>

      <para>As you load reports into the list, you will see a number in
      brackets following the name of each report. This number is the grade
      assigned to each report. The reports will be loaded into the database
      using the grade you see here. By default this grade is zero. If you
      choose to change this value, you may double-click on any of the reports
      in the list to bring up a dialog that will allow you to set the value
      for the grade.</para>

      <para><figure>
          <title>Report Grading</title>

          <mediaobject>
            <imageobject>
              <imagedata fileref="images/C04_120_RptImportToolEditGrade.png" />
            </imageobject>
          </mediaobject>
        </figure></para>

      <para>It is important to remember that when running a report, OpenMFG
      uses the report definition with the highest grade (for example, 10 runs
      before 9). OpenMFG recommends that you never overwrite the report
      definition with grade 0, reserving this for the definition provided by
      OpenMFG.</para>

      <para>If after you are done adding reports to the list you find a report
      which you do not want to upload, simply highlight the report and select
      the REMOVE button. The report will be removed from the list, and it will
      not be uploaded.</para>

      <para>Once you are satisfied with your list of reports and the grades
      you have assigned, highlight individual reports or use the SELECT ALL
      button to select all of the reports for importing. After the desired
      reports have been highlighted, select the IMPORT button. The highlighted
      reports will be uploaded to the database you logged into when you
      started your session.</para>

      <para><figure>
          <title>Selecting Reports To Be Imported</title>

          <mediaobject>
            <imageobject>
              <imagedata fileref="images/C04_130_RptImpTlSelectAll_Import.png" />
            </imageobject>
          </mediaobject>
        </figure></para>

      <para>The Messages section of the Report import Tool shows the status of
      your import.</para>

      <para>To exit, select the EXIT option from the “File” menu--or click on
      the “X” in the upper-right hand corner of the screen.</para>

      <para>After importing report definitions, you may want to open the
      OpenMFG report writer and view the report definitions you
      imported.</para>

      <para><figure>
          <title>Updated Grade After Import</title>

          <mediaobject>
            <imageobject>
              <imagedata fileref="images/C04_140_RptImpToolResult.png" />
            </imageobject>
          </mediaobject>
        </figure></para>

      <para>While report definitions can be loaded from the .xml definition
      file through the report writer itself, the Report Import Tool expedites
      this process when multiple report definitions require
      importation.</para>

      <para>Now let’s look at a tool that enables you to import from the
      operating system’s command line on a client computer.</para>
    </sect2>

    <sect2>
      <title>importrpt</title>

      <para>The command line import tool functions on all supported client
      environments and enables the importation of .xml report definitions over
      the network through a command line on a client computer. Systems
      administration personnel may embed the command line import tool in
      scripts that import multiple report definitions in a single run or use
      it iteratively from the command line.</para>

      <para>The example provided in this document shows the command line
      report import tool being used on a Window client computer. The syntax is
      the same regardless of the operating system.</para>

      <para><figure>
          <title>Using importrpt Tool</title>

          <mediaobject>
            <imageobject>
              <imagedata fileref="images/C04_200_RptImpCMDLine.png" />
            </imageobject>
          </mediaobject>
        </figure></para>

      <para>The name of the binary is importrpt (with the ‘.exe’ extension on
      Windows) and should be collocated with the OpenMFG client application
      files. The table below shows the command, as executed above, in a more
      readable fashion:</para>

      <simpara>importrpt</simpara>

      <simpara>-databaseURL=psql://openmfg.application/newdemo:5432</simpara>

      <simpara>-username=jsmith</simpara>

      <simpara>-passwd=js1app</simpara>

      <simpara>-f=C:\OpenMFG\report_xml\Routing.xml</simpara>

      <simpara>-grade=10</simpara>

      <para>Let’s take a look at all of the options available in importrpt to
      understand each a little better:</para>

      <para><table>
          <title></title>

          <tgroup cols="2">
            <thead>
              <row>
                <entry>Option</entry>

                <entry>Syntax</entry>
              </row>
            </thead>

            <tbody>
              <row rowsep="1">
                <entry colname="1">-databaseURL=&lt;connection URL&gt;</entry>

                <entry colname="2">Specify the connection information that
                importrpt should use when loading a report definition. The
                connection URL is in the following
                format:psql://servername/database[:port]In the connection URL,
                the servername is the host or IP address of the server where
                the database is running.For example: somehost.openmfg.comThe
                database is the name of the actual database you want to
                connect to on the specified server.For example: mydbThe last
                option, port, is optional. If included, it must follow a colon
                and be a valid port number. If the port is not specified, the
                default port of '5432' is used.For example, if you wanted to
                connect to the database 'mydb' on the server
                'somehost.openmfg.com' using the default port, you would use
                the following connection
                URL:psql://somehost.openmfg.com/mydbSimilarly, if you wanted
                to connect to the database 'dbtest' on the server
                '192.168.128.64' using the port 2345 you would use the
                following connection
                URL:psql://192.168.128.64/dbtest:2345</entry>
              </row>

              <row rowsep="1">
                <entry colname="1">-username=&lt;user name&gt;</entry>

                <entry colname="2">This is user name you are using to connect
                to the server and database. It is the same username that the
                user enters when logging on through the OpenMFG client and
                must be setup using the OpenMFG client session Maintain
                Users.</entry>
              </row>

              <row rowsep="1">
                <entry colname="1">-passwd=&lt;password&gt;</entry>

                <entry colname="2">This is the password for the user name you
                specified in Maintain Users. This is the same password that
                the user enters when logging in through the OpenMFG
                client.</entry>
              </row>

              <row rowsep="1">
                <entry colname="1">-grade=&lt;number&gt;</entry>

                <entry colname="2">The grade used to load a report into the
                database. A numeric value from 0 to 99 is valid. The default
                value is 0 if this option is not specified. Grade 0 should
                generally be reserved for the baseline report definition
                supplied by OpenMFG.</entry>
              </row>

              <row rowsep="0">
                <entry colname="1">-f=&lt;report definition&gt;</entry>

                <entry colname="2">The name of the report definition file (as
                it appears on your disk) that you are loading into the
                database. The path may be included if the file is located in a
                directory that is different from the one in which importrpt is
                located and the syntax for the path will vary by operating
                system.</entry>
              </row>
            </tbody>
          </tgroup>
        </table></para>

      <para>You may have noticed that the report definition loaded in our
      example above was for the Routing report and that grade was assigned a
      value of 20. If, after running importrpt, we start the OpenMFG report
      writer and browse the report definitions, we will find that we now have
      an additional report definition for the Routing:</para>

      <para><figure>
          <title>Report Grade Updated</title>

          <mediaobject>
            <imageobject>
              <imagedata fileref="images/C04_210_RptImpCMDLineResult.png" />
            </imageobject>
          </mediaobject>
        </figure></para>

      <para>We can see that Routing has 3 definitions: 0, 10, and 20. When a
      user runs the Routing report, OpenMFG will use the definition with grade
      20: the definition we just imported using the importrpt command line
      tool.</para>

      <para></para>
    </sect2>
  </sect1>
</chapter>